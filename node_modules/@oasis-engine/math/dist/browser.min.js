!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self)["@oasisEngine/math"]={})}(this,(function(t){"use strict";var n,e;t.ContainmentType=void 0,(n=t.ContainmentType||(t.ContainmentType={}))[n.Disjoint=0]="Disjoint",n[n.Contains=1]="Contains",n[n.Intersects=2]="Intersects",t.PlaneIntersectionType=void 0,(e=t.PlaneIntersectionType||(t.PlaneIntersectionType={}))[e.Back=0]="Back",e[e.Front=1]="Front",e[e.Intersecting=2]="Intersecting";var i=function(){function t(){}return t.clamp=function(t,n,e){return Math.max(n,Math.min(e,t))},t.equals=function(n,e){return Math.abs(n-e)<=t.zeroTolerance},t.isPowerOf2=function(t){return 0==(t&t-1)},t.radianToDegree=function(n){return n*t.radToDegreeFactor},t.degreeToRadian=function(n){return n*t.degreeToRadFactor},t}();i.zeroTolerance=1e-6,i.radToDegreeFactor=180/Math.PI,i.degreeToRadFactor=Math.PI/180;var r=function(){function t(t,n,e){void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),this.x=void 0,this.y=void 0,this.z=void 0,this.x=t,this.y=n,this.z=e}t.add=function(t,n,e){e.x=t.x+n.x,e.y=t.y+n.y,e.z=t.z+n.z},t.subtract=function(t,n,e){e.x=t.x-n.x,e.y=t.y-n.y,e.z=t.z-n.z},t.multiply=function(t,n,e){e.x=t.x*n.x,e.y=t.y*n.y,e.z=t.z*n.z},t.divide=function(t,n,e){e.x=t.x/n.x,e.y=t.y/n.y,e.z=t.z/n.z},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z},t.cross=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=n.x,o=n.y,u=n.z;e.x=r*u-s*o,e.y=s*a-i*u,e.z=i*o-r*a},t.distance=function(t,n){var e=n.x-t.x,i=n.y-t.y,r=n.z-t.z;return Math.sqrt(e*e+i*i+r*r)},t.distanceSquared=function(t,n){var e=n.x-t.x,i=n.y-t.y,r=n.z-t.z;return e*e+i*i+r*r},t.equals=function(t,n){return i.equals(t.x,n.x)&&i.equals(t.y,n.y)&&i.equals(t.z,n.z)},t.lerp=function(t,n,e,i){var r=t.x,s=t.y,a=t.z;i.x=r+(n.x-r)*e,i.y=s+(n.y-s)*e,i.z=a+(n.z-a)*e},t.max=function(t,n,e){e.x=Math.max(t.x,n.x),e.y=Math.max(t.y,n.y),e.z=Math.max(t.z,n.z)},t.min=function(t,n,e){e.x=Math.min(t.x,n.x),e.y=Math.min(t.y,n.y),e.z=Math.min(t.z,n.z)},t.negate=function(t,n){n.x=-t.x,n.y=-t.y,n.z=-t.z},t.normalize=function(t,n){var e=t.x,i=t.y,r=t.z,s=Math.sqrt(e*e+i*i+r*r);s>0&&(s=1/s,n.x=e*s,n.y=i*s,n.z=r*s)},t.scale=function(t,n,e){e.x=t.x*n,e.y=t.y*n,e.z=t.z*n},t.transformNormal=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=n.elements;e.x=i*a[0]+r*a[4]+s*a[8],e.y=i*a[1]+r*a[5]+s*a[9],e.z=i*a[2]+r*a[6]+s*a[10]},t.transformToVec3=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=n.elements;e.x=i*a[0]+r*a[4]+s*a[8]+a[12],e.y=i*a[1]+r*a[5]+s*a[9]+a[13],e.z=i*a[2]+r*a[6]+s*a[10]+a[14]},t.transformToVec4=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=n.elements;e.x=i*a[0]+r*a[4]+s*a[8]+a[12],e.y=i*a[1]+r*a[5]+s*a[9]+a[13],e.z=i*a[2]+r*a[6]+s*a[10]+a[14],e.w=i*a[3]+r*a[7]+s*a[11]+a[15]},t.transformCoordinate=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=n.elements,o=i*a[3]+r*a[7]+s*a[11]+a[15];o=1/o,e.x=(i*a[0]+r*a[4]+s*a[8]+a[12])*o,e.y=(i*a[1]+r*a[5]+s*a[9]+a[13])*o,e.z=(i*a[2]+r*a[6]+s*a[10]+a[14])*o},t.transformByQuat=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=n.x,o=n.y,u=n.z,h=n.w,c=h*i+o*s-u*r,l=h*r+u*i-a*s,y=h*s+a*r-o*i,x=-a*i-o*r-u*s;e.x=c*h-x*a-l*u+y*o,e.y=l*h-x*o-y*a+c*u,e.z=y*h-x*u-c*o+l*a};var n=t.prototype;return n.setValue=function(t,n,e){return this.x=t,this.y=n,this.z=e,this},n.setValueByArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},n.length=function(){var t=this.x,n=this.y,e=this.z;return Math.sqrt(t*t+n*n+e*e)},n.lengthSquared=function(){var t=this.x,n=this.y,e=this.z;return t*t+n*n+e*e},n.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},n.normalize=function(){return t.normalize(this,this),this},n.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.toArray=function(t,n){void 0===n&&(n=0),t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z},n.clone=function(){return new t(this.x,this.y,this.z)},n.cloneTo=function(t){return t.x=this.x,t.y=this.y,t.z=this.z,t},n.transformNormal=function(n){return t.transformNormal(this,n,this),this},n.transformToVec3=function(n){return t.transformToVec3(this,n,this),this},n.transformCoordinate=function(n){return t.transformCoordinate(this,n,this),this},n.transformByQuat=function(n){return t.transformByQuat(this,n,this),this},t}();r._zero=new r(0,0,0),r._one=new r(1,1,1);var s=function(){function t(t,n){void 0===t&&(t=null),void 0===n&&(n=0),this.center=new r,this.radius=0,t&&t.cloneTo(this.center),this.radius=n}t.fromPoints=function(n,e){if(!n||0===n.length)throw new Error("points must be array and length must > 0");var i=n.length,s=t._tempVec30;s.x=s.y=s.z=0;for(var a=0;a<i;++a)r.add(n[a],s,s);r.scale(s,1/i,e.center);for(var o=0,u=0;u<i;++u){var h=r.distanceSquared(s,n[u]);h>o&&(o=h)}e.radius=Math.sqrt(o)},t.fromBox=function(t,n){var e=n.center,i=t.min,s=t.max;e.x=.5*(i.x+s.x),e.y=.5*(i.y+s.y),e.z=.5*(i.z+s.z),n.radius=r.distance(e,s)};var n=t.prototype;return n.clone=function(){return new t(this.center,this.radius)},n.cloneTo=function(t){return this.center.cloneTo(t.center),t.radius=this.radius,t},t}();s._tempVec30=new r;var a=function(){function t(t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.min=new r,this.max=new r,t&&t.cloneTo(this.min),n&&n.cloneTo(this.max)}t.fromCenterAndExtent=function(t,n,e){r.subtract(t,n,e.min),r.add(t,n,e.max)},t.fromPoints=function(t,n){if(!t||0===t.length)throw new Error("points must be array and length must > 0");var e=n.min,i=n.max;e.x=e.y=e.z=Number.MAX_VALUE,i.x=i.y=i.z=-Number.MAX_VALUE;for(var s=0,a=t.length;s<a;++s){var o=t[s];r.min(e,o,e),r.max(i,o,i)}},t.fromSphere=function(t,n){var e=t.center,i=t.radius,r=n.min,s=n.max;r.x=e.x-i,r.y=e.y-i,r.z=e.z-i,s.x=e.x+i,s.y=e.y+i,s.z=e.z+i},t.transform=function(n,e,i){var s=t._tempVec30,a=t._tempVec31;n.getCenter(s),n.getExtent(a),r.transformCoordinate(s,e,s);var o=a.x,u=a.y,h=a.z,c=e.elements;a.x=Math.abs(o*c[0])+Math.abs(u*c[4])+Math.abs(h*c[8]),a.y=Math.abs(o*c[1])+Math.abs(u*c[5])+Math.abs(h*c[9]),a.z=Math.abs(o*c[2])+Math.abs(u*c[6])+Math.abs(h*c[10]),r.subtract(s,a,i.min),r.add(s,a,i.max)},t.merge=function(t,n,e){return r.min(t.min,n.min,e.min),r.max(t.max,n.max,e.max),e};var n=t.prototype;return n.clone=function(){return new t(this.min,this.max)},n.cloneTo=function(t){return this.min.cloneTo(t.min),this.max.cloneTo(t.max),t},n.getCenter=function(t){return r.add(this.min,this.max,t),r.scale(t,.5,t),t},n.getExtent=function(t){return r.subtract(this.max,this.min,t),r.scale(t,.5,t),t},n.getCorners=function(t){void 0===t&&(t=[]);var n=this.min,e=this.max,i=n.x,s=n.y,a=n.z,o=e.x,u=e.y,h=e.z,c=t.length;if(c<8)for(var l=0,y=8-c;l<y;++l)t[c+l]=new r;return t[0].setValue(i,u,h),t[1].setValue(o,u,h),t[2].setValue(o,s,h),t[3].setValue(i,s,h),t[4].setValue(i,u,a),t[5].setValue(o,u,a),t[6].setValue(o,s,a),t[7].setValue(i,s,a),t},n.transform=function(n){return t.transform(this,n,this),this},t}();a._tempVec30=new r,a._tempVec31=new r;var o=function(){function n(){}return n.distancePlaneAndPoint=function(t,n){return r.dot(t.normal,n)+t.distance},n.intersectsPlaneAndPoint=function(e,i){var r=n.distancePlaneAndPoint(e,i);return r>0?t.PlaneIntersectionType.Front:r<0?t.PlaneIntersectionType.Back:t.PlaneIntersectionType.Intersecting},n.intersectsPlaneAndBox=function(e,i){var r=i.min,s=i.max,a=e.normal,o=n._tempVec30,u=n._tempVec31;return a.x>=0?(o.x=s.x,u.x=r.x):(o.x=r.x,u.x=s.x),a.y>=0?(o.y=s.y,u.y=r.y):(o.y=r.y,u.y=s.y),a.z>=0?(o.z=s.z,u.z=r.z):(o.z=r.z,u.z=s.z),n.distancePlaneAndPoint(e,o)<0?t.PlaneIntersectionType.Back:n.distancePlaneAndPoint(e,u)>0?t.PlaneIntersectionType.Front:t.PlaneIntersectionType.Intersecting},n.intersectsPlaneAndSphere=function(e,i){var r=i.center,s=i.radius,a=n.distancePlaneAndPoint(e,r);return a>s?t.PlaneIntersectionType.Front:a<-s?t.PlaneIntersectionType.Back:t.PlaneIntersectionType.Intersecting},n.intersectsRayAndPlane=function(t,n){var e=n.normal,s=i.zeroTolerance,a=r.dot(e,t.direction);if(Math.abs(a)<s)return-1;var o=r.dot(e,t.origin),u=(-n.distance-o)/a;if(u<0){if(u<-s)return-1;u=0}return u},n.intersectsRayAndBox=function(t,n){var e=i.zeroTolerance,r=t.origin,s=t.direction,a=n.min,o=n.max,u=s.x,h=s.y,c=s.z,l=r.x,y=r.y,x=r.z,f=0,m=Number.MAX_VALUE;if(Math.abs(u)<e){if(l<a.x||l>o.x)return-1}else{var z=1/u,v=(a.x-l)*z,d=(o.x-l)*z;if(v>d){var w=v;v=d,d=w}if((f=Math.max(v,f))>(m=Math.min(d,m)))return-1}if(Math.abs(h)<e){if(y<a.y||y>o.y)return-1}else{var p=1/h,M=(a.y-y)*p,g=(o.y-y)*p;if(M>g){var T=M;M=g,g=T}if((f=Math.max(M,f))>(m=Math.min(g,m)))return-1}if(Math.abs(c)<e){if(x<a.z||x>o.z)return-1}else{var q=1/c,b=(a.z-x)*q,A=(o.z-x)*q;if(b>A){var V=b;b=A,A=V}if((f=Math.max(b,f))>(m=Math.min(A,m)))return-1}return f},n.intersectsRayAndSphere=function(t,e){var i=t.origin,s=t.direction,a=e.center,o=e.radius,u=n._tempVec30;r.subtract(i,a,u);var h=r.dot(u,s),c=r.dot(u,u)-o*o;if(h>0&&c>0)return-1;var l=h*h-c;if(l<0)return-1;var y=-h-Math.sqrt(l);return y<0&&(y=0),y},n.intersectsBoxAndBox=function(t,n){return!(t.min.x>n.max.x||n.min.x>t.max.x)&&(!(t.min.y>n.max.y||n.min.y>t.max.y)&&!(t.min.z>n.max.z||n.min.z>t.max.z))},n.intersectsSphereAndSphere=function(t,n){var e=t.radius+n.radius;return r.distanceSquared(t.center,n.center)<e*e},n.intersectsSphereAndBox=function(t,e){var i=t.center,s=e.max,a=e.min,o=n._tempVec30;return o.setValue(Math.max(a.x,Math.min(i.x,s.x)),Math.max(a.y,Math.min(i.y,s.y)),Math.max(a.z,Math.min(i.z,s.z))),r.distanceSquared(i,o)<=t.radius*t.radius},n.intersectsFrustumAndBox=function(t,e){for(var i=e.min,s=e.max,a=n._tempVec30,o=0;o<6;++o){var u=t.getPlane(o),h=u.normal;if(a.x=h.x>=0?i.x:s.x,a.y=h.y>=0?i.y:s.y,a.z=h.z>=0?i.z:s.z,r.dot(u.normal,a)>-u.distance)return!1}return!0},n.frustumContainsBox=function(e,i){for(var r=i.min,s=i.max,a=n._tempVec30,o=n._tempVec31,u=t.ContainmentType.Contains,h=0;h<6;++h){var c=e.getPlane(h),l=c.normal;if(l.x>=0?(a.x=s.x,o.x=r.x):(a.x=r.x,o.x=s.x),l.y>=0?(a.y=s.y,o.y=r.y):(a.y=r.y,o.y=s.y),l.z>=0?(a.z=s.z,o.z=r.z):(a.z=r.z,o.z=s.z),n.intersectsPlaneAndPoint(c,o)===t.PlaneIntersectionType.Front)return t.ContainmentType.Disjoint;n.intersectsPlaneAndPoint(c,a)===t.PlaneIntersectionType.Front&&(u=t.ContainmentType.Intersects)}return u},n.frustumContainsSphere=function(e,i){for(var r=t.ContainmentType.Contains,s=0;s<6;++s){var a=e.getPlane(s),o=n.intersectsPlaneAndSphere(a,i);if(o===t.PlaneIntersectionType.Front)return t.ContainmentType.Disjoint;if(o===t.PlaneIntersectionType.Intersecting){r=t.ContainmentType.Intersects;break}}return r},n}();o._tempVec30=new r,o._tempVec31=new r;var u=function(){function t(t,n){void 0===t&&(t=null),void 0===n&&(n=0),this.normal=new r,this.distance=0,t&&t.cloneTo(this.normal),this.distance=n}t.normalize=function(t,n){var e=t.normal,i=1/e.length(),r=n.normal;r.x=e.x*i,r.y=e.y*i,r.z=e.z*i,n.distance=t.distance*i},t.fromPoints=function(t,n,e,i){var r=t.x,s=t.y,a=t.z,o=n.x-r,u=n.y-s,h=n.z-a,c=e.x-r,l=e.y-s,y=e.z-a,x=u*y-h*l,f=h*c-o*y,m=o*l-u*c,z=1/Math.sqrt(x*x+f*f+m*m),v=x*z,d=f*z,w=m*z,p=i.normal;p.x=v,p.y=d,p.z=w,i.distance=-(v*r+d*s+w*a)};var n=t.prototype;return n.normalize=function(){return t.normalize(this,this),this},n.clone=function(){var n=new t;return this.cloneTo(n),n},n.cloneTo=function(t){return this.normal.cloneTo(t.normal),t.distance=this.distance,t},t}(),h=function(){function n(t){void 0===t&&(t=null),this.near=void 0,this.far=void 0,this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0,this.near=new u,this.far=new u,this.left=new u,this.right=new u,this.top=new u,this.bottom=new u,t&&this.calculateFromMatrix(t)}var e=n.prototype;return e.clone=function(){var t=new n;return this.cloneTo(t),t},e.cloneTo=function(t){return this.near.cloneTo(t.near),this.far.cloneTo(t.far),this.left.cloneTo(t.left),this.right.cloneTo(t.right),this.top.cloneTo(t.top),this.bottom.cloneTo(t.bottom),t},e.getPlane=function(t){switch(t){case 0:return this.near;case 1:return this.far;case 2:return this.left;case 3:return this.right;case 4:return this.top;case 5:return this.bottom;default:return null}},e.calculateFromMatrix=function(t){var n=t.elements,e=n[0],i=n[1],r=n[2],s=n[3],a=n[4],o=n[5],u=n[6],h=n[7],c=n[8],l=n[9],y=n[10],x=n[11],f=n[12],m=n[13],z=n[14],v=n[15],d=this.near.normal;d.x=-s-r,d.y=-h-u,d.z=-x-y,this.near.distance=-v-z,this.near.normalize();var w=this.far.normal;w.x=r-s,w.y=u-h,w.z=y-x,this.far.distance=z-v,this.far.normalize();var p=this.left.normal;p.x=-s-e,p.y=-h-a,p.z=-x-c,this.left.distance=-v-f,this.left.normalize();var M=this.right.normal;M.x=e-s,M.y=a-h,M.z=c-x,this.right.distance=f-v,this.right.normalize();var g=this.top.normal;g.x=i-s,g.y=o-h,g.z=l-x,this.top.distance=m-v,this.top.normalize();var T=this.bottom.normal;T.x=-s-i,T.y=-h-o,T.z=-x-l,this.bottom.distance=-v-m,this.bottom.normalize()},e.intersectsBox=function(t){return o.intersectsFrustumAndBox(this,t)},e.intersectsSphere=function(n){return o.frustumContainsSphere(this,n)!==t.ContainmentType.Disjoint},n}(),c=function(){function t(t,n,e,i,r,s,a,o,u){void 0===t&&(t=1),void 0===n&&(n=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===s&&(s=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===u&&(u=1),this.elements=new Float32Array(9);var h=this.elements;h[0]=t,h[1]=n,h[2]=e,h[3]=i,h[4]=r,h[5]=s,h[6]=a,h[7]=o,h[8]=u}t.add=function(t,n,e){var i=t.elements,r=n.elements,s=e.elements;s[0]=i[0]+r[0],s[1]=i[1]+r[1],s[2]=i[2]+r[2],s[3]=i[3]+r[3],s[4]=i[4]+r[4],s[5]=i[5]+r[5],s[6]=i[6]+r[6],s[7]=i[7]+r[7],s[8]=i[8]+r[8]},t.subtract=function(t,n,e){var i=t.elements,r=n.elements,s=e.elements;s[0]=i[0]-r[0],s[1]=i[1]-r[1],s[2]=i[2]-r[2],s[3]=i[3]-r[3],s[4]=i[4]-r[4],s[5]=i[5]-r[5],s[6]=i[6]-r[6],s[7]=i[7]-r[7],s[8]=i[8]-r[8]},t.multiply=function(t,n,e){var i=t.elements,r=n.elements,s=e.elements,a=i[0],o=i[1],u=i[2],h=i[3],c=i[4],l=i[5],y=i[6],x=i[7],f=i[8],m=r[0],z=r[1],v=r[2],d=r[3],w=r[4],p=r[5],M=r[6],g=r[7],T=r[8];s[0]=a*m+h*z+y*v,s[1]=o*m+c*z+x*v,s[2]=u*m+l*z+f*v,s[3]=a*d+h*w+y*p,s[4]=o*d+c*w+x*p,s[5]=u*d+l*w+f*p,s[6]=a*M+h*g+y*T,s[7]=o*M+c*g+x*T,s[8]=u*M+l*g+f*T},t.equals=function(t,n){var e=t.elements,r=n.elements;return i.equals(e[0],r[0])&&i.equals(e[1],r[1])&&i.equals(e[2],r[2])&&i.equals(e[3],r[3])&&i.equals(e[4],r[4])&&i.equals(e[5],r[5])&&i.equals(e[6],r[6])&&i.equals(e[7],r[7])&&i.equals(e[8],r[8])},t.lerp=function(t,n,e,i){var r=t.elements,s=n.elements,a=i.elements,o=1-e;a[0]=r[0]*o+s[0]*e,a[1]=r[1]*o+s[1]*e,a[2]=r[2]*o+s[2]*e,a[3]=r[3]*o+s[3]*e,a[4]=r[4]*o+s[4]*e,a[5]=r[5]*o+s[5]*e,a[6]=r[6]*o+s[6]*e,a[7]=r[7]*o+s[7]*e,a[8]=r[8]*o+s[8]*e},t.rotationQuaternion=function(t,n){var e=n.elements,i=t.x,r=t.y,s=t.z,a=t.w,o=i+i,u=r+r,h=s+s,c=i*o,l=r*o,y=r*u,x=s*o,f=s*u,m=s*h,z=a*o,v=a*u,d=a*h;e[0]=1-y-m,e[3]=l-d,e[6]=x+v,e[1]=l+d,e[4]=1-c-m,e[7]=f-z,e[2]=x-v,e[5]=f+z,e[8]=1-c-y},t.scaling=function(t,n){var e=n.elements;e[0]=t.x,e[1]=0,e[2]=0,e[3]=0,e[4]=t.y,e[5]=0,e[6]=0,e[7]=0,e[8]=1},t.translation=function(t,n){var e=n.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t.x,e[7]=t.y,e[8]=1},t.invert=function(t,n){var e=t.elements,i=n.elements,r=e[0],s=e[1],a=e[2],o=e[3],u=e[4],h=e[5],c=e[6],l=e[7],y=e[8],x=y*u-h*l,f=-y*o+h*c,m=l*o-u*c,z=r*x+s*f+a*m;z&&(z=1/z,i[0]=x*z,i[1]=(-y*s+a*l)*z,i[2]=(h*s-a*u)*z,i[3]=f*z,i[4]=(y*r-a*c)*z,i[5]=(-h*r+a*o)*z,i[6]=m*z,i[7]=(-l*r+s*c)*z,i[8]=(u*r-s*o)*z)},t.normalMatrix=function(t,n){var e=t.elements,i=n.elements,r=e[0],s=e[1],a=e[2],o=e[3],u=e[4],h=e[5],c=e[6],l=e[7],y=e[8],x=e[9],f=e[10],m=e[11],z=e[12],v=e[13],d=e[14],w=e[15],p=r*h-s*u,M=r*c-a*u,g=r*l-o*u,T=s*c-a*h,q=s*l-o*h,b=a*l-o*c,A=y*v-x*z,V=y*d-f*z,P=y*w-m*z,_=x*d-f*v,B=x*w-m*v,S=f*w-m*d,I=p*S-M*B+g*_+T*P-q*V+b*A;if(!I)return null;I=1/I,i[0]=(h*S-c*B+l*_)*I,i[1]=(c*P-u*S-l*V)*I,i[2]=(u*B-h*P+l*A)*I,i[3]=(a*B-s*S-o*_)*I,i[4]=(r*S-a*P+o*V)*I,i[5]=(s*P-r*B-o*A)*I,i[6]=(v*b-d*q+w*T)*I,i[7]=(d*g-z*b-w*M)*I,i[8]=(z*q-v*g+w*p)*I},t.rotate=function(t,n,e){var i=t.elements,r=e.elements,s=Math.sin(n),a=Math.cos(n),o=i[0],u=i[1],h=i[2],c=i[3],l=i[4],y=i[5],x=i[6],f=i[7],m=i[8];r[0]=a*o+s*c,r[1]=a*u+s*l,r[2]=a*h+s*y,r[3]=a*c-s*o,r[4]=a*l-s*u,r[5]=a*y-s*h,r[6]=x,r[7]=f,r[8]=m},t.scale=function(t,n,e){var i=n.x,r=n.y,s=t.elements,a=e.elements;a[0]=i*s[0],a[1]=i*s[1],a[2]=i*s[2],a[3]=r*s[3],a[4]=r*s[4],a[5]=r*s[5],a[6]=s[6],a[7]=s[7],a[8]=s[8]},t.translate=function(t,n,e){var i=n.x,r=n.y,s=t.elements,a=e.elements,o=s[0],u=s[1],h=s[2],c=s[3],l=s[4],y=s[5],x=s[6],f=s[7],m=s[8];a[0]=o,a[1]=u,a[2]=h,a[3]=c,a[4]=l,a[5]=y,a[6]=i*o+r*c+x,a[7]=i*u+r*l+f,a[8]=i*h+r*y+m},t.transpose=function(t,n){var e=t.elements,i=n.elements;if(n===t){var r=e[1],s=e[2],a=e[5];i[1]=e[3],i[2]=e[6],i[3]=r,i[5]=e[7],i[6]=s,i[7]=a}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8]};var n=t.prototype;return n.setValue=function(t,n,e,i,r,s,a,o,u){var h=this.elements;return h[0]=t,h[1]=n,h[2]=e,h[3]=i,h[4]=r,h[5]=s,h[6]=a,h[7]=o,h[8]=u,this},n.setValueByArray=function(t,n){void 0===n&&(n=0);for(var e=this.elements,i=0;i<12;i++)e[i]=t[i+n];return this},n.setValueByMatrix=function(t){var n=t.elements,e=this.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[4],e[4]=n[5],e[5]=n[6],e[6]=n[8],e[7]=n[9],e[8]=n[10],this},n.toArray=function(t,n){void 0===n&&(n=0);var e=this.elements;t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3],t[n+4]=e[4],t[n+5]=e[5],t[n+6]=e[6],t[n+7]=e[7],t[n+8]=e[8]},n.clone=function(){var n=this.elements;return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},n.cloneTo=function(t){var n=this.elements,e=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],t},n.add=function(n){return t.add(this,n,this),this},n.subtract=function(n){return t.subtract(this,n,this),this},n.multiply=function(n){return t.multiply(this,n,this),this},n.determinant=function(){var t=this.elements,n=t[0],e=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],u=t[7],h=t[8];return n*(h*s-a*u)+e*(-h*r+a*o)+i*(u*r-s*o)},n.identity=function(){var t=this.elements;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},n.invert=function(){return t.invert(this,this),this},n.rotate=function(n){return t.rotate(this,n,this),this},n.scale=function(n){return t.scale(this,n,this),this},n.translate=function(n){return t.translate(this,n,this),this},n.transpose=function(){return t.transpose(this,this),this},t}(),l=function(){function t(t,n,e,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),void 0===i&&(i=1),this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=t,this.y=n,this.z=e,this.w=i}t.add=function(t,n,e){e.x=t.x+n.x,e.y=t.y+n.y,e.z=t.z+n.z,e.w=t.w+n.w},t.multiply=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=t.w,o=n.x,u=n.y,h=n.z,c=n.w;e.x=i*c+a*o+r*h-s*u,e.y=r*c+a*u+s*o-i*h,e.z=s*c+a*h+i*u-r*o,e.w=a*c-i*o-r*u-s*h},t.conjugate=function(t,n){n.x=-t.x,n.y=-t.y,n.z=-t.z,n.w=t.w},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z+t.w*n.w},t.equals=function(t,n){return i.equals(t.x,n.x)&&i.equals(t.y,n.y)&&i.equals(t.z,n.z)&&i.equals(t.w,n.w)},t.rotationAxisAngle=function(n,e,i){var s=t._tempVector3;r.normalize(n,s),e*=.5;var a=Math.sin(e);i.x=s.x*a,i.y=s.y*a,i.z=s.z*a,i.w=Math.cos(e)},t.rotationEuler=function(n,e,i,r){t.rotationYawPitchRoll(e,n,i,r)},t.rotationYawPitchRoll=function(t,n,e,i){var r=.5*e,s=.5*n,a=.5*t,o=Math.sin(r),u=Math.cos(r),h=Math.sin(s),c=Math.cos(s),l=Math.sin(a),y=Math.cos(a),x=y*c,f=l*h;i.x=y*h*u+l*c*o,i.y=l*c*u-y*h*o,i.z=x*o-f*u,i.w=x*u+f*o},t.rotationMatrix3x3=function(t,n){var e,i,r=t.elements,s=r[0],a=r[1],o=r[2],u=r[3],h=r[4],c=r[5],l=r[6],y=r[7],x=r[8],f=s+h+x;f>0?(e=Math.sqrt(f+1),n.w=.5*e,e=.5/e,n.x=(c-y)*e,n.y=(l-o)*e,n.z=(a-u)*e):s>=h&&s>=x?(i=.5/(e=Math.sqrt(1+s-h-x)),n.x=.5*e,n.y=(a+u)*i,n.z=(o+l)*i,n.w=(c-y)*i):h>x?(i=.5/(e=Math.sqrt(1+h-s-x)),n.x=(u+a)*i,n.y=.5*e,n.z=(y+c)*i,n.w=(l-o)*i):(i=.5/(e=Math.sqrt(1+x-s-h)),n.x=(o+l)*i,n.y=(c+y)*i,n.z=.5*e,n.w=(a-u)*i)},t.invert=function(t,n){var e=t.x,r=t.y,s=t.z,a=t.w,o=e*e+r*r+s*s+a*a;if(o>i.zeroTolerance){var u=1/o;n.x=-e*u,n.y=-r*u,n.z=-s*u,n.w=a*u}},t.lerp=function(n,e,i,r){var s=1-i;t.dot(n,e)>=0?(r.x=n.x*s+e.x*i,r.y=n.y*s+e.y*i,r.z=n.z*s+e.z*i,r.w=n.w*s+e.w*i):(r.x=n.x*s-e.x*i,r.y=n.y*s-e.y*i,r.z=n.z*s-e.z*i,r.w=n.w*s-e.w*i),r.normalize()},t.slerp=function(t,n,e,r){var s,a,o=t.x,u=t.y,h=t.z,c=t.w,l=n.x,y=n.y,x=n.z,f=n.w,m=o*l+u*y+h*x+c*f;if(m<0&&(m=-m,l=-l,y=-y,x=-x,f=-f),1-m>i.zeroTolerance){var z=Math.acos(m),v=Math.sin(z);s=Math.sin((1-e)*z)/v,a=Math.sin(e*z)/v}else s=1-e,a=e;r.x=s*o+a*l,r.y=s*u+a*y,r.z=s*h+a*x,r.w=s*c+a*f},t.normalize=function(t,n){var e=t.x,r=t.y,s=t.z,a=t.w,o=Math.sqrt(e*e+r*r+s*s+a*a);o>i.zeroTolerance&&(o=1/o,n.x=e*o,n.y=r*o,n.z=s*o,n.w=a*o)},t.rotationX=function(t,n){t*=.5;var e=Math.sin(t),i=Math.cos(t);n.x=e,n.y=0,n.z=0,n.w=i},t.rotationY=function(t,n){t*=.5;var e=Math.sin(t),i=Math.cos(t);n.x=0,n.y=e,n.z=0,n.w=i},t.rotationZ=function(t,n){t*=.5;var e=Math.sin(t),i=Math.cos(t);n.x=0,n.y=0,n.z=e,n.w=i},t.rotateX=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=t.w;n*=.5;var o=Math.sin(n),u=Math.cos(n);e.x=i*u+a*o,e.y=r*u+s*o,e.z=s*u-r*o,e.w=a*u-i*o},t.rotateY=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=t.w;n*=.5;var o=Math.sin(n),u=Math.cos(n);e.x=i*u-s*o,e.y=r*u+a*o,e.z=s*u+i*o,e.w=a*u-r*o},t.rotateZ=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=t.w;n*=.5;var o=Math.sin(n),u=Math.cos(n);e.x=i*u+r*o,e.y=r*u-i*o,e.z=s*u+a*o,e.w=a*u-s*o},t.scale=function(t,n,e){e.x=t.x*n,e.y=t.y*n,e.z=t.z*n,e.w=t.w*n};var n=t.prototype;return n.setValue=function(t,n,e,i){return this.x=t,this.y=n,this.z=e,this.w=i,this},n.setValueByArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this},n.conjugate=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},n.getAxisAngle=function(t){var n=this.x,e=this.y,r=this.z,s=n*n+e*e+r*r;if(s<i.zeroTolerance)return t.x=1,t.y=0,t.z=0,0;var a=1/s;return t.x=this.x*a,t.y=this.y*a,t.z=this.z*a,2*Math.acos(this.w)},n.identity=function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},n.length=function(){var t=this.x,n=this.y,e=this.z,i=this.w;return Math.sqrt(t*t+n*n+e*e+i*i)},n.lengthSquared=function(){var t=this.x,n=this.y,e=this.z,i=this.w;return t*t+n*n+e*e+i*i},n.normalize=function(){return t.normalize(this,this),this},n.toEuler=function(t){this.toYawPitchRoll(t);var n=t.x;return t.x=t.y,t.y=n,t},n.toYawPitchRoll=function(t){var n=this.x,e=this.y,r=this.z,s=this.w,a=n*n,o=e*e,u=r*r,h=n*e,c=r*s,l=r*n,y=e*s,x=e*r,f=n*s;return t.y=Math.asin(2*(f-x)),Math.cos(t.y)>i.zeroTolerance?(t.z=Math.atan2(2*(h+c),1-2*(u+a)),t.x=Math.atan2(2*(l+y),1-2*(o+a))):(t.z=Math.atan2(-2*(h-c),1-2*(o+u)),t.x=0),t},n.toArray=function(t,n){void 0===n&&(n=0),t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w},n.clone=function(){return new t(this.x,this.y,this.z,this.w)},n.cloneTo=function(t){return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},n.rotateX=function(n){return t.rotateX(this,n,this),this},n.rotateY=function(n){return t.rotateY(this,n,this),this},n.rotateZ=function(n){return t.rotateZ(this,n,this),this},n.rotationAxisAngle=function(n,e){return t.rotationAxisAngle(n,e,this),this},n.multiply=function(n){return t.multiply(this,n,this),this},n.invert=function(){return t.invert(this,this),this},n.dot=function(n){return t.dot(this,n)},n.lerp=function(n,e){return t.lerp(this,n,e,this),this},n.rotateAxisAngle=function(n,e){return t._tempQuat1.rotationAxisAngle(n,e),this.multiply(t._tempQuat1),this},t}();l._tempVector3=new r,l._tempQuat1=new l;var y=function(){function t(t,n,e,i,r,s,a,o,u,h,c,l,y,x,f,m){void 0===t&&(t=1),void 0===n&&(n=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1),void 0===a&&(a=0),void 0===o&&(o=0),void 0===u&&(u=0),void 0===h&&(h=0),void 0===c&&(c=1),void 0===l&&(l=0),void 0===y&&(y=0),void 0===x&&(x=0),void 0===f&&(f=0),void 0===m&&(m=1),this.elements=new Float32Array(16);var z=this.elements;z[0]=t,z[1]=n,z[2]=e,z[3]=i,z[4]=r,z[5]=s,z[6]=a,z[7]=o,z[8]=u,z[9]=h,z[10]=c,z[11]=l,z[12]=y,z[13]=x,z[14]=f,z[15]=m}t.multiply=function(t,n,e){var i=t.elements,r=n.elements,s=e.elements,a=i[0],o=i[1],u=i[2],h=i[3],c=i[4],l=i[5],y=i[6],x=i[7],f=i[8],m=i[9],z=i[10],v=i[11],d=i[12],w=i[13],p=i[14],M=i[15],g=r[0],T=r[1],q=r[2],b=r[3],A=r[4],V=r[5],P=r[6],_=r[7],B=r[8],S=r[9],I=r[10],C=r[11],F=r[12],R=r[13],E=r[14],Q=r[15];s[0]=a*g+c*T+f*q+d*b,s[1]=o*g+l*T+m*q+w*b,s[2]=u*g+y*T+z*q+p*b,s[3]=h*g+x*T+v*q+M*b,s[4]=a*A+c*V+f*P+d*_,s[5]=o*A+l*V+m*P+w*_,s[6]=u*A+y*V+z*P+p*_,s[7]=h*A+x*V+v*P+M*_,s[8]=a*B+c*S+f*I+d*C,s[9]=o*B+l*S+m*I+w*C,s[10]=u*B+y*S+z*I+p*C,s[11]=h*B+x*S+v*I+M*C,s[12]=a*F+c*R+f*E+d*Q,s[13]=o*F+l*R+m*E+w*Q,s[14]=u*F+y*R+z*E+p*Q,s[15]=h*F+x*R+v*E+M*Q},t.equals=function(t,n){var e=t.elements,r=n.elements;return i.equals(e[0],r[0])&&i.equals(e[1],r[1])&&i.equals(e[2],r[2])&&i.equals(e[3],r[3])&&i.equals(e[4],r[4])&&i.equals(e[5],r[5])&&i.equals(e[6],r[6])&&i.equals(e[7],r[7])&&i.equals(e[8],r[8])&&i.equals(e[9],r[9])&&i.equals(e[10],r[10])&&i.equals(e[11],r[11])&&i.equals(e[12],r[12])&&i.equals(e[13],r[13])&&i.equals(e[14],r[14])&&i.equals(e[15],r[15])},t.lerp=function(t,n,e,i){var r=t.elements,s=n.elements,a=i.elements,o=1-e;a[0]=r[0]*o+s[0]*e,a[1]=r[1]*o+s[1]*e,a[2]=r[2]*o+s[2]*e,a[3]=r[3]*o+s[3]*e,a[4]=r[4]*o+s[4]*e,a[5]=r[5]*o+s[5]*e,a[6]=r[6]*o+s[6]*e,a[7]=r[7]*o+s[7]*e,a[8]=r[8]*o+s[8]*e,a[9]=r[9]*o+s[9]*e,a[10]=r[10]*o+s[10]*e,a[11]=r[11]*o+s[11]*e,a[12]=r[12]*o+s[12]*e,a[13]=r[13]*o+s[13]*e,a[14]=r[14]*o+s[14]*e,a[15]=r[15]*o+s[15]*e},t.rotationQuaternion=function(t,n){var e=n.elements,i=t.x,r=t.y,s=t.z,a=t.w,o=i+i,u=r+r,h=s+s,c=i*o,l=r*o,y=r*u,x=s*o,f=s*u,m=s*h,z=a*o,v=a*u,d=a*h;e[0]=1-y-m,e[1]=l+d,e[2]=x-v,e[3]=0,e[4]=l-d,e[5]=1-c-m,e[6]=f+z,e[7]=0,e[8]=x+v,e[9]=f-z,e[10]=1-c-y,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1},t.rotationAxisAngle=function(t,n,e){var r,s,a,o=e.elements,u=t.x,h=t.y,c=t.z,l=Math.sqrt(u*u+h*h+c*c);Math.abs(l)<i.zeroTolerance||(u*=l=1/l,h*=l,c*=l,r=Math.sin(n),a=1-(s=Math.cos(n)),o[0]=u*u*a+s,o[1]=h*u*a+c*r,o[2]=c*u*a-h*r,o[3]=0,o[4]=u*h*a-c*r,o[5]=h*h*a+s,o[6]=c*h*a+u*r,o[7]=0,o[8]=u*c*a+h*r,o[9]=h*c*a-u*r,o[10]=c*c*a+s,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1)},t.rotationTranslation=function(n,e,i){t.rotationQuaternion(n,i);var r=i.elements;r[12]=e.x,r[13]=e.y,r[14]=e.z},t.affineTransformation=function(t,n,e,i){var r=i.elements,s=n.x,a=n.y,o=n.z,u=n.w,h=s+s,c=a+a,l=o+o,y=s*h,x=s*c,f=s*l,m=a*c,z=a*l,v=o*l,d=u*h,w=u*c,p=u*l,M=t.x,g=t.y,T=t.z;r[0]=(1-(m+v))*M,r[1]=(x+p)*M,r[2]=(f-w)*M,r[3]=0,r[4]=(x-p)*g,r[5]=(1-(y+v))*g,r[6]=(z+d)*g,r[7]=0,r[8]=(f+w)*T,r[9]=(z-d)*T,r[10]=(1-(y+m))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1},t.scaling=function(t,n){var e=n.elements;e[0]=t.x,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t.y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t.z,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1},t.translation=function(t,n){var e=n.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t.x,e[13]=t.y,e[14]=t.z,e[15]=1},t.invert=function(t,n){var e=t.elements,i=n.elements,r=e[0],s=e[1],a=e[2],o=e[3],u=e[4],h=e[5],c=e[6],l=e[7],y=e[8],x=e[9],f=e[10],m=e[11],z=e[12],v=e[13],d=e[14],w=e[15],p=r*h-s*u,M=r*c-a*u,g=r*l-o*u,T=s*c-a*h,q=s*l-o*h,b=a*l-o*c,A=y*v-x*z,V=y*d-f*z,P=y*w-m*z,_=x*d-f*v,B=x*w-m*v,S=f*w-m*d,I=p*S-M*B+g*_+T*P-q*V+b*A;if(!I)return null;I=1/I,i[0]=(h*S-c*B+l*_)*I,i[1]=(a*B-s*S-o*_)*I,i[2]=(v*b-d*q+w*T)*I,i[3]=(f*q-x*b-m*T)*I,i[4]=(c*P-u*S-l*V)*I,i[5]=(r*S-a*P+o*V)*I,i[6]=(d*g-z*b-w*M)*I,i[7]=(y*b-f*g+m*M)*I,i[8]=(u*B-h*P+l*A)*I,i[9]=(s*P-r*B-o*A)*I,i[10]=(z*q-v*g+w*p)*I,i[11]=(x*g-y*q-m*p)*I,i[12]=(h*V-u*_-c*A)*I,i[13]=(r*_-s*V+a*A)*I,i[14]=(v*M-z*T-d*p)*I,i[15]=(y*T-x*M+f*p)*I},t.lookAt=function(n,e,i,s){var a=s.elements,o=t._tempVec30,u=t._tempVec31,h=t._tempVec32;r.subtract(n,e,h),h.normalize(),r.cross(i,h,o),o.normalize(),r.cross(h,o,u),a[0]=o.x,a[1]=u.x,a[2]=h.x,a[3]=0,a[4]=o.y,a[5]=u.y,a[6]=h.y,a[7]=0,a[8]=o.z,a[9]=u.z,a[10]=h.z,a[11]=0,a[12]=-r.dot(o,n),a[13]=-r.dot(u,n),a[14]=-r.dot(h,n),a[15]=1},t.ortho=function(t,n,e,i,r,s,a){var o=a.elements,u=1/(t-n),h=1/(e-i),c=1/(r-s);o[0]=-2*u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*h,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*c,o[11]=0,o[12]=(t+n)*u,o[13]=(i+e)*h,o[14]=(s+r)*c,o[15]=1},t.perspective=function(t,n,e,i,r){var s=r.elements,a=1/Math.tan(t/2),o=1/(e-i);s[0]=a/n,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=a,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=(i+e)*o,s[11]=-1,s[12]=0,s[13]=0,s[14]=2*i*e*o,s[15]=0},t.rotateAxisAngle=function(t,n,e,r){var s=n.x,a=n.y,o=n.z,u=Math.sqrt(s*s+a*a+o*o);if(!(Math.abs(u)<i.zeroTolerance)){var h,c,l,y=t.elements,x=r.elements;s*=u=1/u,a*=u,o*=u,h=Math.sin(e),l=1-(c=Math.cos(e));var f=y[0],m=y[1],z=y[2],v=y[3],d=y[4],w=y[5],p=y[6],M=y[7],g=y[8],T=y[9],q=y[10],b=y[11],A=s*s*l+c,V=a*s*l+o*h,P=o*s*l-a*h,_=s*a*l-o*h,B=a*a*l+c,S=o*a*l+s*h,I=s*o*l+a*h,C=a*o*l-s*h,F=o*o*l+c;x[0]=f*A+d*V+g*P,x[1]=m*A+w*V+T*P,x[2]=z*A+p*V+q*P,x[3]=v*A+M*V+b*P,x[4]=f*_+d*B+g*S,x[5]=m*_+w*B+T*S,x[6]=z*_+p*B+q*S,x[7]=v*_+M*B+b*S,x[8]=f*I+d*C+g*F,x[9]=m*I+w*C+T*F,x[10]=z*I+p*C+q*F,x[11]=v*I+M*C+b*F,t!==r&&(x[12]=y[12],x[13]=y[13],x[14]=y[14],x[15]=y[15])}},t.scale=function(t,n,e){var i=t.elements,r=e.elements,s=n.x,a=n.y,o=n.z;r[0]=i[0]*s,r[1]=i[1]*s,r[2]=i[2]*s,r[3]=i[3]*s,r[4]=i[4]*a,r[5]=i[5]*a,r[6]=i[6]*a,r[7]=i[7]*a,r[8]=i[8]*o,r[9]=i[9]*o,r[10]=i[10]*o,r[11]=i[11]*o,r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15]},t.translate=function(t,n,e){var i=t.elements,r=e.elements,s=n.x,a=n.y,o=n.z;if(t===e)r[12]=i[0]*s+i[4]*a+i[8]*o+i[12],r[13]=i[1]*s+i[5]*a+i[9]*o+i[13],r[14]=i[2]*s+i[6]*a+i[10]*o+i[14],r[15]=i[3]*s+i[7]*a+i[11]*o+i[15];else{var u=i[0],h=i[1],c=i[2],l=i[3],y=i[4],x=i[5],f=i[6],m=i[7],z=i[8],v=i[9],d=i[10],w=i[11];r[0]=u,r[1]=h,r[2]=c,r[3]=l,r[4]=y,r[5]=x,r[6]=f,r[7]=m,r[8]=z,r[9]=v,r[10]=d,r[11]=w,r[12]=u*s+y*a+z*o+i[12],r[13]=h*s+x*a+v*o+i[13],r[14]=c*s+f*a+d*o+i[14],r[15]=l*s+m*a+w*o+i[15]}},t.transpose=function(t,n){var e=t.elements,i=n.elements;if(n===t){var r=e[1],s=e[2],a=e[3],o=e[6],u=e[7],h=e[11];i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=r,i[6]=e[9],i[7]=e[13],i[8]=s,i[9]=o,i[11]=e[14],i[12]=a,i[13]=u,i[14]=h}else i[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15]};var n=t.prototype;return n.setValue=function(t,n,e,i,r,s,a,o,u,h,c,l,y,x,f,m){var z=this.elements;return z[0]=t,z[1]=n,z[2]=e,z[3]=i,z[4]=r,z[5]=s,z[6]=a,z[7]=o,z[8]=u,z[9]=h,z[10]=c,z[11]=l,z[12]=y,z[13]=x,z[14]=f,z[15]=m,this},n.setValueByArray=function(t,n){void 0===n&&(n=0);for(var e=this.elements,i=0;i<16;i++)e[i]=t[i+n];return this},n.toArray=function(t,n){void 0===n&&(n=0);var e=this.elements;t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3],t[n+4]=e[4],t[n+5]=e[5],t[n+6]=e[6],t[n+7]=e[7],t[n+8]=e[8],t[n+9]=e[9],t[n+10]=e[10],t[n+11]=e[11],t[n+12]=e[12],t[n+13]=e[13],t[n+14]=e[14],t[n+15]=e[15]},n.clone=function(){var n=this.elements;return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])},n.cloneTo=function(t){var n=this.elements,e=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],t},n.multiply=function(n){return t.multiply(this,n,this),this},n.determinant=function(){var t=this.elements,n=t[0],e=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],u=t[7],h=t[8],c=t[9],l=t[10],y=t[11],x=t[12],f=t[13],m=t[14],z=t[15];return(n*a-e*s)*(l*z-y*m)-(n*o-i*s)*(c*z-y*f)+(n*u-r*s)*(c*m-l*f)+(e*o-i*a)*(h*z-y*x)-(e*u-r*a)*(h*m-l*x)+(i*u-r*o)*(h*f-c*x)},n.decompose=function(n,e,r){var s=t._tempMat30,a=this.elements,o=s.elements,u=a[0],h=a[1],c=a[2],y=a[3],x=a[4],f=a[5],m=a[6],z=a[7],v=a[8],d=a[9],w=a[10],p=a[11];n.x=a[12],n.y=a[13],n.z=a[14];var M=Math.sign(u*h*c*y)<0?-1:1,g=Math.sign(x*f*m*z)<0?-1:1,T=Math.sign(v*d*w*p)<0?-1:1,q=M*Math.sqrt(u*u+h*h+c*c),b=g*Math.sqrt(x*x+f*f+m*m),A=T*Math.sqrt(v*v+d*d+w*w);if(r.x=q,r.y=b,r.z=A,Math.abs(q)<i.zeroTolerance||Math.abs(b)<i.zeroTolerance||Math.abs(A)<i.zeroTolerance)return e.identity(),!1;var V=1/q,P=1/b,_=1/A;return o[0]=u*V,o[1]=h*V,o[2]=c*V,o[3]=x*P,o[4]=f*P,o[5]=m*P,o[6]=v*_,o[7]=d*_,o[8]=w*_,l.rotationMatrix3x3(s,e),!0},n.getRotation=function(t){var n=this.elements,e=n[0]+n[5]+n[10];if(e>i.zeroTolerance){var r=2*Math.sqrt(e+1);t.w=.25*r,t.x=(n[6]-n[9])/r,t.y=(n[8]-n[2])/r,t.z=(n[1]-n[4])/r}else if(n[0]>n[5]&&n[0]>n[10]){var s=2*Math.sqrt(1+n[0]-n[5]-n[10]);t.w=(n[6]-n[9])/s,t.x=.25*s,t.y=(n[1]+n[4])/s,t.z=(n[8]+n[2])/s}else if(n[5]>n[10]){var a=2*Math.sqrt(1+n[5]-n[0]-n[10]);t.w=(n[8]-n[2])/a,t.x=(n[1]+n[4])/a,t.y=.25*a,t.z=(n[6]+n[9])/a}else{var o=2*Math.sqrt(1+n[10]-n[0]-n[5]);t.w=(n[1]-n[4])/o,t.x=(n[8]+n[2])/o,t.y=(n[6]+n[9])/o,t.z=.25*o}return t},n.getScaling=function(t){var n=this.elements,e=n[0],i=n[1],r=n[2],s=n[4],a=n[5],o=n[6],u=n[8],h=n[9],c=n[10];return t.x=Math.sqrt(e*e+i*i+r*r),t.y=Math.sqrt(s*s+a*a+o*o),t.z=Math.sqrt(u*u+h*h+c*c),t},n.getTranslation=function(t){var n=this.elements;return t.x=n[12],t.y=n[13],t.z=n[14],t},n.identity=function(){var t=this.elements;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},n.invert=function(){return t.invert(this,this),this},n.rotateAxisAngle=function(n,e){return t.rotateAxisAngle(this,n,e,this),this},n.scale=function(n){return t.scale(this,n,this),this},n.translate=function(n){return t.translate(this,n,this),this},n.transpose=function(){return t.transpose(this,this),this},t}();y._tempVec30=new r,y._tempVec31=new r,y._tempVec32=new r,y._tempMat30=new c,y._identity=new y(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);var x=function(){function t(t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.origin=new r,this.direction=new r,t&&t.cloneTo(this.origin),n&&n.cloneTo(this.direction)}var n=t.prototype;return n.intersectPlane=function(t){return o.intersectsRayAndPlane(this,t)},n.intersectSphere=function(t){return o.intersectsRayAndSphere(this,t)},n.intersectBox=function(t){return o.intersectsRayAndBox(this,t)},n.getPoint=function(t,n){return r.scale(this.direction,t,n),n.add(this.origin)},t}(),f=function(){function t(t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.x=void 0,this.y=void 0,this.x=t,this.y=n}t.add=function(t,n,e){e.x=t.x+n.x,e.y=t.y+n.y},t.subtract=function(t,n,e){e.x=t.x-n.x,e.y=t.y-n.y},t.multiply=function(t,n,e){e.x=t.x*n.x,e.y=t.y*n.y},t.divide=function(t,n,e){e.x=t.x/n.x,e.y=t.y/n.y},t.dot=function(t,n){return t.x*n.x+t.y*n.y},t.distance=function(t,n){var e=n.x-t.x,i=n.y-t.y;return Math.sqrt(e*e+i*i)},t.distanceSquared=function(t,n){var e=n.x-t.x,i=n.y-t.y;return e*e+i*i},t.equals=function(t,n){return i.equals(t.x,n.x)&&i.equals(t.y,n.y)},t.lerp=function(t,n,e,i){var r=t.x,s=t.y;i.x=r+(n.x-r)*e,i.y=s+(n.y-s)*e},t.max=function(t,n,e){e.x=Math.max(t.x,n.x),e.y=Math.max(t.y,n.y)},t.min=function(t,n,e){e.x=Math.min(t.x,n.x),e.y=Math.min(t.y,n.y)},t.negate=function(t,n){n.x=-t.x,n.y=-t.y},t.normalize=function(t,n){var e=t.x,r=t.y,s=Math.sqrt(e*e+r*r);s>i.zeroTolerance&&(s=1/s,n.x=e*s,n.y=r*s)},t.scale=function(t,n,e){e.x=t.x*n,e.y=t.y*n};var n=t.prototype;return n.setValue=function(t,n){return this.x=t,this.y=n,this},n.setValueByArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this},n.length=function(){var t=this.x,n=this.y;return Math.sqrt(t*t+n*n)},n.lengthSquared=function(){var t=this.x,n=this.y;return t*t+n*n},n.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.normalize=function(){return t.normalize(this,this),this},n.scale=function(t){return this.x*=t,this.y*=t,this},n.toArray=function(t,n){void 0===n&&(n=0),t[n]=this.x,t[n+1]=this.y},n.clone=function(){return new t(this.x,this.y)},n.cloneTo=function(t){return t.x=this.x,t.y=this.y,t},t}();f._zero=new f(0,0),f._one=new f(1,1);var m=function(){function t(t,n,e,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=t,this.y=n,this.z=e,this.w=i}t.add=function(t,n,e){e.x=t.x+n.x,e.y=t.y+n.y,e.z=t.z+n.z,e.w=t.w+n.w},t.subtract=function(t,n,e){e.x=t.x-n.x,e.y=t.y-n.y,e.z=t.z-n.z,e.w=t.w-n.w},t.multiply=function(t,n,e){e.x=t.x*n.x,e.y=t.y*n.y,e.z=t.z*n.z,e.w=t.w*n.w},t.divide=function(t,n,e){e.x=t.x/n.x,e.y=t.y/n.y,e.z=t.z/n.z,e.w=t.w/n.w},t.dot=function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z+t.w*n.w},t.distance=function(t,n){var e=n.x-t.x,i=n.y-t.y,r=n.z-t.z,s=n.w-t.w;return Math.sqrt(e*e+i*i+r*r+s*s)},t.distanceSquared=function(t,n){var e=n.x-t.x,i=n.y-t.y,r=n.z-t.z,s=n.w-t.w;return e*e+i*i+r*r+s*s},t.equals=function(t,n){return i.equals(t.x,n.x)&&i.equals(t.y,n.y)&&i.equals(t.z,n.z)&&i.equals(t.w,n.w)},t.lerp=function(t,n,e,i){var r=t.x,s=t.y,a=t.z,o=t.w;i.x=r+(n.x-r)*e,i.y=s+(n.y-s)*e,i.z=a+(n.z-a)*e,i.w=o+(n.w-o)*e},t.max=function(t,n,e){e.x=Math.max(t.x,n.x),e.y=Math.max(t.y,n.y),e.z=Math.max(t.z,n.z),e.w=Math.max(t.w,n.w)},t.min=function(t,n,e){e.x=Math.min(t.x,n.x),e.y=Math.min(t.y,n.y),e.z=Math.min(t.z,n.z),e.w=Math.min(t.w,n.w)},t.negate=function(t,n){n.x=-t.x,n.y=-t.y,n.z=-t.z,n.w=-t.w},t.normalize=function(t,n){var e=t.x,r=t.y,s=t.z,a=t.w,o=Math.sqrt(e*e+r*r+s*s+a*a);o>i.zeroTolerance&&(o=1/o,n.x=e*o,n.y=r*o,n.z=s*o,n.w=a*o)},t.scale=function(t,n,e){e.x=t.x*n,e.y=t.y*n,e.z=t.z*n,e.w=t.w*n},t.transform=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=t.w,o=n.elements;e.x=i*o[0]+r*o[4]+s*o[8]+a*o[12],e.y=i*o[1]+r*o[5]+s*o[9]+a*o[13],e.z=i*o[2]+r*o[6]+s*o[10]+a*o[14],e.w=i*o[3]+r*o[7]+s*o[11]+a*o[15]},t.transformByQuat=function(t,n,e){var i=t.x,r=t.y,s=t.z,a=t.w,o=n.x,u=n.y,h=n.z,c=n.w,l=c*i+u*s-h*r,y=c*r+h*i-o*s,x=c*s+o*r-u*i,f=-o*i-u*r-h*s;e.x=l*c-f*o-y*h+x*u,e.y=y*c-f*u-x*o+l*h,e.z=x*c-f*h-l*u+y*o,e.w=a};var n=t.prototype;return n.setValue=function(t,n,e,i){return this.x=t,this.y=n,this.z=e,this.w=i,this},n.setValueByArray=function(t,n){return void 0===n&&(n=0),this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this},n.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},n.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},n.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},n.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this},n.length=function(){var t=this.x,n=this.y,e=this.z,i=this.w;return Math.sqrt(t*t+n*n+e*e+i*i)},n.lengthSquared=function(){var t=this.x,n=this.y,e=this.z,i=this.w;return t*t+n*n+e*e+i*i},n.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},n.normalize=function(){return t.normalize(this,this),this},n.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.toArray=function(t,n){void 0===n&&(n=0),t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w},n.clone=function(){return new t(this.x,this.y,this.z,this.w)},n.cloneTo=function(t){return t.x=this.x,t.y=this.y,t.z=this.z,t.w=this.w,t},t}();m._zero=new m(0,0,0,0),m._one=new m(1,1,1,1);var z=function(){function t(t,n,e,i){void 0===t&&(t=1),void 0===n&&(n=1),void 0===e&&(e=1),void 0===i&&(i=1),this.r=void 0,this.g=void 0,this.b=void 0,this.a=void 0,this.r=t,this.g=n,this.b=e,this.a=i}t.gammaToLinearSpace=function(t){return t<=0?0:t<=.04045?t/12.92:t<1?Math.pow((t+.055)/1.055,2.4):Math.pow(t,2.4)},t.linearToGammaSpace=function(t){return t<=0?0:t<.0031308?12.92*t:t<1?1.055*Math.pow(t,.41666)-.055:Math.pow(t,.41666)},t.equals=function(t,n){return i.equals(t.r,n.r)&&i.equals(t.g,n.g)&&i.equals(t.b,n.b)&&i.equals(t.a,n.a)},t.add=function(t,n,e){return e.r=t.r+n.r,e.g=t.g+n.g,e.b=t.b+n.b,e.a=t.a+n.a,e},t.scale=function(t,n,e){return e.r=t.r*n,e.g=t.g*n,e.b=t.b*n,e.a=t.a*n,e};var n=t.prototype;return n.setValue=function(t,n,e,i){return this.r=t,this.g=n,this.b=e,this.a=i,this},n.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},n.scale=function(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this},n.clone=function(){return new t(this.r,this.g,this.b,this.a)},n.cloneTo=function(t){return t.r=this.r,t.g=this.g,t.b=this.b,t.a=this.a,t},n.toLinear=function(n){return n.r=t.gammaToLinearSpace(this.r),n.g=t.gammaToLinearSpace(this.g),n.b=t.gammaToLinearSpace(this.b),n},n.toGamma=function(n){return n.r=t.linearToGammaSpace(this.r),n.g=t.linearToGammaSpace(this.g),n.b=t.linearToGammaSpace(this.b),n},t}(),v=function(){function t(t,n,e,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.x=t,this.y=n,this.width=e,this.height=i}var n=t.prototype;return n.setValue=function(t,n,e,i){return this.x=t,this.y=n,this.width=e,this.height=i,this},n.clone=function(){return new t(this.x,this.y,this.width,this.height)},n.cloneTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t}(),d=function(){function t(){this.coefficients=new Float32Array(27)}var n=t.prototype;return n.addLight=function(t,n,e){n.scale(e);var i=this.coefficients,r=t.x,s=t.y,a=t.z,o=n.r,u=n.g,h=n.b,c=.282095,l=-.488603*s,y=.488603*a,x=-.488603*r,f=r*s*1.092548,m=s*a*-1.092548,z=.315392*(3*a*a-1),v=r*a*-1.092548,d=.546274*(r*r-s*s);i[0]+=o*c,i[1]+=u*c,i[2]+=h*c,i[3]+=o*l,i[4]+=u*l,i[5]+=h*l,i[6]+=o*y,i[7]+=u*y,i[8]+=h*y,i[9]+=o*x,i[10]+=u*x,i[11]+=h*x,i[12]+=o*f,i[13]+=u*f,i[14]+=h*f,i[15]+=o*m,i[16]+=u*m,i[17]+=h*m,i[18]+=o*z,i[19]+=u*z,i[20]+=h*z,i[21]+=o*v,i[22]+=u*v,i[23]+=h*v,i[24]+=o*d,i[25]+=u*d,i[26]+=h*d},n.evaluate=function(t,n){var e=this.coefficients,i=t.x,r=t.y,s=t.z,a=.886227,o=-1.023327*r,u=1.023327*s,h=-1.023327*i,c=.858086*r*i,l=-.858086*r*s,y=.247708*(3*s*s-1),x=-.858086*s*i,f=.429042*(i*i-r*r),m=e[0]*a,z=e[1]*a,v=e[2]*a;return m+=e[3]*o+e[6]*u+e[9]*h,z+=e[4]*o+e[7]*u+e[10]*h,v+=e[5]*o+e[8]*u+e[11]*h,m+=e[12]*c+e[15]*l+e[18]*y+e[21]*x+e[24]*f,z+=e[13]*c+e[16]*l+e[19]*y+e[22]*x+e[25]*f,v+=e[14]*c+e[17]*l+e[20]*y+e[23]*x+e[26]*f,n.setValue(m,z,v,1),n},n.scale=function(t){var n=this.coefficients;n[0]*=t,n[1]*=t,n[2]*=t,n[3]*=t,n[4]*=t,n[5]*=t,n[6]*=t,n[7]*=t,n[8]*=t,n[9]*=t,n[10]*=t,n[11]*=t,n[12]*=t,n[13]*=t,n[14]*=t,n[15]*=t,n[16]*=t,n[17]*=t,n[18]*=t,n[19]*=t,n[20]*=t,n[21]*=t,n[22]*=t,n[23]*=t,n[24]*=t,n[25]*=t,n[26]*=t},n.setValueByArray=function(t,n){void 0===n&&(n=0);var e=this.coefficients;e[0]=t[n],e[1]=t[1+n],e[2]=t[2+n],e[3]=t[3+n],e[4]=t[4+n],e[5]=t[5+n],e[6]=t[6+n],e[7]=t[7+n],e[8]=t[8+n],e[9]=t[9+n],e[10]=t[10+n],e[11]=t[11+n],e[12]=t[12+n],e[13]=t[13+n],e[14]=t[14+n],e[15]=t[15+n],e[16]=t[16+n],e[17]=t[17+n],e[18]=t[18+n],e[19]=t[19+n],e[20]=t[20+n],e[21]=t[21+n],e[22]=t[22+n],e[23]=t[23+n],e[24]=t[24+n],e[25]=t[25+n],e[26]=t[26+n]},n.toArray=function(t,n){void 0===n&&(n=0);var e=this.coefficients;t[0+n]=e[0],t[1+n]=e[1],t[2+n]=e[2],t[3+n]=e[3],t[4+n]=e[4],t[5+n]=e[5],t[6+n]=e[6],t[7+n]=e[7],t[8+n]=e[8],t[9+n]=e[9],t[10+n]=e[10],t[11+n]=e[11],t[12+n]=e[12],t[13+n]=e[13],t[14+n]=e[14],t[15+n]=e[15],t[16+n]=e[16],t[17+n]=e[17],t[18+n]=e[18],t[19+n]=e[19],t[20+n]=e[20],t[21+n]=e[21],t[22+n]=e[22],t[23+n]=e[23],t[24+n]=e[24],t[25+n]=e[25],t[26+n]=e[26]},n.clone=function(){var n=new t;return this.cloneTo(n),n},n.cloneTo=function(t){return this.toArray(t.coefficients),t},t}();t.BoundingBox=a,t.BoundingFrustum=h,t.BoundingSphere=s,t.CollisionUtil=o,t.Color=z,t.MathUtil=i,t.Matrix=y,t.Matrix3x3=c,t.Plane=u,t.Quaternion=l,t.Ray=x,t.Rect=v,t.SphericalHarmonics3=d,t.Vector2=f,t.Vector3=r,t.Vector4=m,Object.defineProperty(t,"__esModule",{value:!0})}));
